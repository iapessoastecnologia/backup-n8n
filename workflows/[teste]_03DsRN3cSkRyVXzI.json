{"createdAt":"2025-07-07T11:21:50.915Z","updatedAt":"2025-07-07T13:13:19.810Z","id":"03DsRN3cSkRyVXzI","name":"[teste]","active":false,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[20,20],"id":"45f041d2-12fd-40cb-986f-2009dd06ef25","name":"When clicking ‘Execute workflow’"},{"parameters":{"documentId":{"__rl":true,"value":"1pWFBVM5WpvHauBM21QJnH7RhGLuS7h3cLy277tmQ-h4","mode":"list","cachedResultName":"2","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1pWFBVM5WpvHauBM21QJnH7RhGLuS7h3cLy277tmQ-h4/edit?usp=drivesdk"},"sheetName":{"__rl":true,"value":1330859790,"mode":"list","cachedResultName":"Table 1","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1pWFBVM5WpvHauBM21QJnH7RhGLuS7h3cLy277tmQ-h4/edit#gid=1330859790"},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[220,20],"id":"daac3226-b06d-4812-8c27-7b4eb57ce005","name":"Google Sheets","credentials":{"googleSheetsOAuth2Api":{"id":"tygFBBOupO6wlHLF","name":"Estagio Financeiro"}}},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.1,"position":[420,-240],"id":"8849da74-9f05-4077-9843-0638dcae7aaa","name":"Merge"},{"parameters":{"fileSelector":"V:\\4. Usuários\\1. Ativos\\Bernardo Cunha\\Projeto C MARINHO\\Fornecedores\\1","options":{}},"type":"n8n-nodes-base.readWriteFile","typeVersion":1,"position":[660,-320],"id":"96619db9-5780-401d-a508-94f252c38dcb","name":"Read/Write Files from Disk"},{"parameters":{"options":{}},"type":"n8n-nodes-base.extractFromFile","typeVersion":1,"position":[600,-300],"id":"c42fd077-ad07-4953-8ca8-61b9b6428bea","name":"Extract from File"},{"parameters":{"jsCode":"// Entrada: items como array de objetos do Google Sheets node\nconst rows = items.map(item => item.json);\n\n// Encontrar índice da linha que contém \"Código\"\nlet headerIndex = rows.findIndex(row => {\n  return Object.values(row).some(cell => typeof cell === \"string\" && cell.toLowerCase().includes(\"código\"));\n});\n\nif (headerIndex === -1) {\n  throw new Error(\"Cabeçalho não encontrado\");\n}\n\n// Definir header: valores da linha do header\nconst headerRow = rows[headerIndex];\nconst header = Object.values(headerRow);\n\n// Filtrar linhas abaixo do header\nconst dataRows = rows.slice(headerIndex + 1);\n\n// Mapear cada linha em objeto com keys do header\nlet output = dataRows.map(row => {\n  const values = Object.values(row);\n  let obj = {};\n  header.forEach((col, i) => {\n    obj[col] = values[i];\n  });\n  return obj;\n});\n\n// Filtrar somente linhas cujo primeiro campo inicia com \"US\"\noutput = output.filter(row => {\n  // Pega a primeira coluna do header\n  const firstKey = header[0];\n  const value = row[firstKey];\n  return typeof value === \"string\" && value.startsWith(\"US\");\n});\n\n// Retornar como items\nreturn output.map(row => ({ json: row }));\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[440,20],"id":"f9280d7a-da28-4671-bba1-7bc4d5dd3d62","name":"Code","alwaysOutputData":true}],"connections":{"When clicking ‘Execute workflow’":{"main":[[{"node":"Google Sheets","type":"main","index":0}]]},"Google Sheets":{"main":[[{"node":"Code","type":"main","index":0}]]},"Read/Write Files from Disk":{"main":[[]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"c7eb5ec2-7d21-4760-adfb-5ec76cdd311b","triggerCount":0,"shared":[{"createdAt":"2025-07-07T11:21:50.915Z","updatedAt":"2025-07-07T11:21:50.915Z","role":"workflow:owner","workflowId":"03DsRN3cSkRyVXzI","projectId":"g8BnYlos8HJUUVcr","project":{"createdAt":"2025-05-28T13:28:04.746Z","updatedAt":"2025-05-28T13:31:33.202Z","id":"g8BnYlos8HJUUVcr","name":"IA Pessoas <comercial@castelobrancocontabilidade.com.br>","type":"personal","icon":null,"description":null,"projectRelations":[{"createdAt":"2025-05-28T13:28:04.746Z","updatedAt":"2025-05-28T13:28:04.746Z","userId":"17ee4480-754a-4392-9fc2-a6bc3c46ebad","projectId":"g8BnYlos8HJUUVcr","user":{"createdAt":"2025-05-28T13:28:03.022Z","updatedAt":"2025-10-08T03:00:53.489Z","id":"17ee4480-754a-4392-9fc2-a6bc3c46ebad","email":"comercial@castelobrancocontabilidade.com.br","firstName":"IA","lastName":"Pessoas","personalizationAnswers":{"version":"v4","personalization_survey_submitted_at":"2025-05-28T13:31:41.717Z","personalization_survey_n8n_version":"1.94.1"},"settings":{"userActivated":true,"easyAIWorkflowOnboarded":true,"firstSuccessfulWorkflowId":"fN5uSWvKRujKur6R","userActivatedAt":1757621781409,"npsSurvey":{"responded":true,"lastShownAt":1749478378830},"dismissedCallouts":{"preBuiltAgentsCalloutHttpRequest":true,"preBuiltAgentsCalloutGoogleDrive":true,"preBuiltAgentsModalCallout":true,"preBuiltAgentsCallout":true}},"disabled":false,"mfaEnabled":false,"lastActiveAt":"2025-10-08","isPending":false}}]}}],"tags":[]}