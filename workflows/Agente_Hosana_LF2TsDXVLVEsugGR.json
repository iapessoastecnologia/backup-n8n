{"createdAt":"2025-07-31T11:08:21.993Z","id":"LF2TsDXVLVEsugGR","name":"Agente Hosana","active":false,"isArchived":false,"nodes":[{"parameters":{"promptType":"define","text":"=Mensagem do Usuario : {{ $json.chatInput }}\nArquivos enviados pelo usuário: {{ $json.files }}\nData e hora da mensagem : {{ $now }}","options":{"systemMessage":"Você é um assistente pessoal chamado Bit.\nVocê responde a Hosana e deve chamar pelo nome.\n\nVocê é responsável por me ajudar em taréfas do dia a dia.\nVocê tem acesso:\n- Ao meu gmail\n- A minha Agenda\n\nPara criar eventos se baseie na data passada abaixo\n\nPara cancelar/deletar e alterar eventos, primeiro consulte na agenda baseado no que o usuario pedir e com esse ID faça o cancelamento "}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2,"position":[-256,0],"id":"caa4f943-0df9-4914-8ff4-9fba9cb13642","name":"AI Agent"},{"parameters":{"contextWindowLength":10},"type":"@n8n/n8n-nodes-langchain.memoryBufferWindow","typeVersion":1.3,"position":[-192,240],"id":"dac42dc5-181f-4f0f-ab8d-be3b3e22062f","name":"Simple Memory"},{"parameters":{"options":{"allowFileUploads":true}},"type":"@n8n/n8n-nodes-langchain.chatTrigger","typeVersion":1.3,"position":[-1104,-16],"id":"489b2a0f-7b9d-4871-944c-18c2496e5d7d","name":"When chat message received","webhookId":"a3a8574b-7312-4693-b937-6ceb7eddab4b"},{"parameters":{"model":{"__rl":true,"value":"gpt-4o-mini","mode":"list","cachedResultName":"gpt-4o-mini"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-352,240],"id":"6944a9a3-524a-403b-ab89-ba07548c9b7f","name":"OpenAI Chat Model"},{"parameters":{"sseEndpoint":"https://webhook.iapessoas.com.br/mcp/8fc6a0c0-f8e9-461c-af64-0ab6d46e67fa"},"type":"@n8n/n8n-nodes-langchain.mcpClientTool","typeVersion":1,"position":[400,240],"id":"c3007cbb-681c-4ea7-bb58-a8ee03f504a3","name":"MCP_Agenda"},{"parameters":{"endpointUrl":"https://webhook.iapessoas.com.br/mcp/mcp-email-iapessoas"},"type":"@n8n/n8n-nodes-langchain.mcpClientTool","typeVersion":1.1,"position":[640,0],"id":"ef1245f2-adaf-4771-9fd7-7f939435614f","name":"MCP Client","disabled":true},{"parameters":{"sendTo":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('To', ``, 'string') }}","subject":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}","message":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}","options":{}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[64,240],"id":"06a13883-8ee8-4194-8a8a-949fcba58911","name":"Send a message in Gmail","webhookId":"5d2950cd-ffe6-4914-a8dd-2c5720f3ebba"},{"parameters":{"operation":"getAll","returnAll":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}","simple":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Simplify', ``, 'boolean') }}","filters":{"q":"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Search', ``, 'string') }}"},"options":{}},"type":"n8n-nodes-base.gmailTool","typeVersion":2.1,"position":[256,240],"id":"6cf4a115-f681-4db3-83e4-0a132eec3a85","name":"Get many messages in Gmail","webhookId":"f30c113a-d250-477b-9043-979399b03218"},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"=","rightValue":"","operator":{"type":"boolean","operation":"exists","singleValue":true},"id":"fd5d1765-e4c0-438e-8254-f6c180c90072"}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"63604667-5c22-4c20-8a9c-0ad9cfac9bca","leftValue":"","rightValue":"","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[-368,-320],"id":"5a4cc1be-4eb0-4996-98a4-85586b2dc43d","name":"Switch"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"17020bf2-5de7-40bf-9dfa-7b04699b9dd0","leftValue":"=={{ $json.files.length}}","rightValue":"=0","operator":{"type":"string","operation":"empty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-672,-16],"id":"dd08fa18-ab9c-4146-9edd-f25ea168e9dc","name":"If"},{"parameters":{"jsCode":"return [\n  {\n    json: {\n      hasFiles: Array.isArray($json.files) && $json.files.length > 0\n    }\n  }\n];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-896,-16],"id":"4eee03a4-d0d9-45f9-bf50-f3e7578926cd","name":"Code"}],"connections":{"AI Agent":{"main":[[]]},"Simple Memory":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]},"When chat message received":{"main":[[{"node":"Code","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"MCP_Agenda":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"MCP Client":{"ai_tool":[[]]},"Send a message in Gmail":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"Get many messages in Gmail":{"ai_tool":[[{"node":"AI Agent","type":"ai_tool","index":0}]]},"If":{"main":[[{"node":"Switch","type":"main","index":0}]]}}}