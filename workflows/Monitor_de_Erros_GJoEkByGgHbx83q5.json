{"createdAt":"2025-07-30T12:17:39.155Z","id":"GJoEkByGgHbx83q5","name":"Monitor de Erros","active":true,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.errorTrigger","typeVersion":1,"position":[-656,0],"id":"e315dd01-1abc-4173-b4f3-74854d517beb","name":"Error Trigger"},{"parameters":{"resource":"message","guildId":{"__rl":true,"value":"1412776659505119316","mode":"list","cachedResultName":"Desenvolvimento - Dep IA","cachedResultUrl":"[REDACTED]"},"channelId":{"__rl":true,"value":"1425492829551067266","mode":"list","cachedResultName":"erros-n8n","cachedResultUrl":"[REDACTED]"},"content":"={{ $json.content }}","options":{}},"type":"n8n-nodes-base.discord","typeVersion":2,"position":[-208,0],"id":"72824148-e4b3-44cb-b07a-8e3a4df979f6","name":"Send a message","webhookId":"7afc0727-ec71-4101-b36b-93a5f48105c4"},{"parameters":{"jsCode":"const exec = $json.execution || {};\nconst wf = $json.workflow || {};\nconst err = exec.error || {};\n\n// ğŸ”¹ Truncar mensagens muito grandes (Discord = 2000 chars mÃ¡x)\nfunction truncar(texto, limite = 1800) {\n  if (!texto) return '';\n  return texto.length > limite ? texto.substring(0, limite) + ' [...]' : texto;\n}\n\n// ğŸ”¹ Corrigir URL (substitui 'webhook' por 'n8n')\nlet urlCorrigida = exec.url || '#';\nif (urlCorrigida.startsWith('https://webhook.')) {\n  urlCorrigida = urlCorrigida.replace('https://webhook.', 'https://n8n.');\n}\n\n// ğŸ”¹ Mensagem de alerta com menÃ§Ã£o de role\nconst cabecalho = `ğŸš¨ **AtenÃ§Ã£o <@&1412776735401054219>, novo erro de execuÃ§Ã£o detectado!**\\n`;\n\nconst msg = `\n${cabecalho}\nâš ï¸ **Erro Detectado no n8n**\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nğŸ§  **Workflow:** ${wf.name || 'Desconhecido'} (ID: ${wf.id || 'N/D'})\nğŸ’¥ **Mensagem:** ${truncar(err.message, 300) || 'Sem descriÃ§Ã£o'}\nğŸ“ **Ãšltimo NÃ³:** ${exec.lastNodeExecuted || 'N/D'}\nâ™»ï¸ **Retry Of:** ${exec.retryOf || 'N/A'}\nğŸ§© **Modo:** ${exec.mode || 'N/D'}\nğŸ”— **ExecuÃ§Ã£o:** [Abrir no n8n](${urlCorrigida})\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nğŸ“œ **Stack (parcial):**\n\\`\\`\\`\n${truncar(err.stack, 1000) || 'NÃ£o informado'}\n\\`\\`\\`\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n`;\n\nreturn [{ json: { content: msg || 'âš ï¸ Nenhuma mensagem gerada pelo Code Node' } }];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-416,0],"id":"7fd84a61-31b3-4058-91b2-b67468260725","name":"Code in JavaScript"}],"connections":{"Error Trigger":{"main":[[{"node":"Code in JavaScript","type":"main","index":0}]]},"Code in JavaScript":{"main":[[{"node":"Send a message","type":"main","index":0}]]}}}