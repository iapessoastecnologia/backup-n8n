{"createdAt":"2025-09-25T14:20:16.880Z","id":"pkJtMjww4I8kjzOk","name":"Contatos Omie - Focus","active":true,"isArchived":false,"nodes":[{"parameters":{"method":"POST","url":"[REDACTED]","sendBody":true,"contentType":"raw","rawContentType":"application/json","body":"[REDACTED]","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2336,-800],"id":"9a34da60-58f8-4bef-8655-a0440c2245aa","name":"HTTP Request","retryOnFail":true,"waitBetweenTries":5000},{"parameters":{"jsCode":"const { pagina, total_de_paginas } = items[0].json;\nif (pagina < total_de_paginas) {\n  return [{ json: { pagina: pagina + 1 } }];\n} else {\n  return [];\n}\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2592,-800],"id":"edee99d3-2466-4228-90e6-09e4b9452e02","name":"Code"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[2096,-816],"id":"583ee7c7-8729-487f-8ca2-c4e24d6d5d38","name":"Loop Over Items"},{"parameters":{"content":"Criando Planilha com Dados Clientes\n","height":368,"width":2344,"color":3},"type":"n8n-nodes-base.stickyNote","position":[1296,-896],"typeVersion":1,"id":"a7621477-1db6-4e11-b51d-c0a1b36c7216","name":"Sticky Note"},{"parameters":{"operation":"appendOrUpdate","documentId":{"__rl":true,"value":"[REDACTED]","mode":"list","cachedResultName":"Contatos - Focus","cachedResultUrl":"[REDACTED]"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"PÃ¡gina1","cachedResultUrl":"[REDACTED]"},"columns":{"mappingMode":"autoMapInputData","value":{"codigo_cliente_omie":"={{ $json.codigo_cliente_omie }}","nome":"={{ $json.nome }}","contato":"={{ $json.contato }}","telefone1":"={{ $json.telefone1 }}","telefone2":"={{ $json.telefone2 }}","cnpj_cpf":"={{ $json.cnpj_cpf }}"},"matchingColumns":["codigo_cliente_omie"],"schema":[{"id":"codigo_cliente_omie","displayName":"codigo_cliente_omie","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"nome","displayName":"nome","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"contato","displayName":"contato","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"telefone1","displayName":"telefone1","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"telefone2","displayName":"telefone2","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"cnpj_cpf","displayName":"cnpj_cpf","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[3376,-784],"id":"a1d97f68-eb31-43aa-a830-4823006bb0e4","name":"Google Sheets1"},{"parameters":{"jsCode":"const clientes = items[0].json.clientes_cadastro || [];\n\nreturn clientes.map(cliente => {\n  const codigo = cliente.codigo_cliente_omie;\n  const nome = cliente.razao_social || cliente.nome_fantasia || 'Cliente';\n  const contato = cliente.contato || '';\n\n  const telefone1 = (cliente.telefone1_ddd ?? '') + (cliente.telefone1_numero ?? '');\n  const telefone2 = (cliente.telefone2_ddd ?? '') + (cliente.telefone2_numero ?? '');\n\n  // Novo campo CNPJ/CPF\n  const cnpj_cpf = cliente.cnpj_cpf || null;\n\n  return {\n    json: {\n      codigo_cliente_omie: codigo,\n      nome: nome,\n      contato: contato,\n      telefone1: telefone1 !== '' ? telefone1 : null,\n      telefone2: telefone2 !== '' ? telefone2 : null,\n      cnpj_cpf: cnpj_cpf\n    }\n  };\n});\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[3072,-784],"id":"3a8570e5-3210-433a-b04a-71ffaa346785","name":"Code1","alwaysOutputData":true},{"parameters":{},"type":"n8n-nodes-base.merge","typeVersion":3.2,"position":[2832,-784],"id":"8b43ca9c-ac67-4a67-b67b-2eaf02a82e46","name":"Merge"},{"parameters":{"method":"POST","url":"[REDACTED]","sendBody":true,"contentType":"raw","rawContentType":"application/json","body":"[REDACTED]","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1600,-816],"id":"57e59dee-bb80-433a-8c72-e09a61780478","name":"HTTP Request1"},{"parameters":{"jsCode":"const { total_de_paginas } = items[0].json;\nconst paginas = [];\nfor (let i = 1; i <= total_de_paginas; i++) {\n  paginas.push({ json: { pagina: i } });\n}\nreturn paginas;\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1808,-816],"id":"06866f61-2375-4df2-9f1d-61bb03463c69","name":"Code in JavaScript"},{"parameters":{"rule":{"interval":[{"triggerAtHour":6}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[1360,-816],"id":"328c019e-2369-40ef-913f-d32e08ce58e9","name":"Schedule Trigger"}],"connections":{"HTTP Request":{"main":[[{"node":"Code","type":"main","index":0},{"node":"Merge","type":"main","index":0}]]},"Code":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"HTTP Request","type":"main","index":0}]]},"Code1":{"main":[[{"node":"Google Sheets1","type":"main","index":0}]]},"Google Sheets1":{"main":[[]]},"Merge":{"main":[[{"node":"Code1","type":"main","index":0}]]},"HTTP Request1":{"main":[[{"node":"Code in JavaScript","type":"main","index":0}]]},"Code in JavaScript":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"HTTP Request1","type":"main","index":0}]]}}}